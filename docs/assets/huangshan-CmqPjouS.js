import{R as Ee,S as we,T as Te,U as Le,q as Me,c as ae,n as K,V as E,m as Re,f as H,W as Ae,d as le,P as Pe,r as D,k as _e,X as Be,l as V,Y as Q,Z as re,$ as Ne,a0 as Oe,a1 as De,a2 as O,a3 as $e,a4 as ze,b as u,a5 as x,a6 as p,a7 as Fe,a8 as $,I as j,p as oe,y as We,a9 as qe,w as ie,t as je,aa as ee}from"./index-BurNYFqW.js";import{c as Ue,C as Ke}from"./index-CU5QDDCG.js";import{u as ce}from"./index-B9QZ0Jph.js";function se(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function He(e,n){if(se(e)){if(n.required)return!1;if(n.validateEmpty===!1)return!0}return!(n.pattern&&!n.pattern.test(String(e)))}function Ye(e,n){return new Promise(r=>{const g=n.validator(e,n);if(Te(g)){g.then(r);return}r(g)})}function te(e,n){const{message:r}=n;return Le(r)?r(e,n):r||""}function Xe({target:e}){e.composing=!0}function ne({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function Je(e,n){const r=Ee();e.style.height="auto";let g=e.scrollHeight;if(Me(n)){const{maxHeight:i,minHeight:s}=n;i!==void 0&&(g=Math.min(g,i)),s!==void 0&&(g=Math.max(g,s))}g&&(e.style.height=`${g}px`,we(r))}function Ze(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function y(e){return[...e].length}function U(e,n){return[...e].slice(0,n).join("")}const[Ge,b]=ae("field"),Y={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:K,formatter:Function,clearIcon:E("clear"),modelValue:Re(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,clearTrigger:E("focus"),formatTrigger:E("onChange"),spellcheck:{type:Boolean,default:null},error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},Qe=H({},Ue,Y,{rows:K,type:E("text"),rules:Array,autosize:[Boolean,Object],labelWidth:K,labelClass:Ae,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var pe=le({name:Ge,props:Qe,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:r}){const g=ce(),i=Pe({status:"unvalidated",focused:!1,validateMessage:""}),s=D(),M=D(),w=D(),{parent:m}=_e(Be),I=()=>{var t;return String((t=e.modelValue)!=null?t:"")},f=t=>{if(x(e[t]))return e[t];if(m&&x(m.props[t]))return m.props[t]},z=V(()=>{const t=f("readonly");if(e.clearable&&!t){const a=I()!=="",l=e.clearTrigger==="always"||e.clearTrigger==="focus"&&i.focused;return a&&l}return!1}),R=V(()=>w.value&&r.input?w.value():e.modelValue),F=V(()=>{var t;const a=f("required");return a==="auto"?(t=e.rules)==null?void 0:t.some(l=>l.required):a}),W=t=>t.reduce((a,l)=>a.then(()=>{if(i.status==="failed")return;let{value:c}=R;if(l.formatter&&(c=l.formatter(c,l)),!He(c,l)){i.status="failed",i.validateMessage=te(c,l);return}if(l.validator)return se(c)&&l.validateEmpty===!1?void 0:Ye(c,l).then(d=>{d&&typeof d=="string"?(i.status="failed",i.validateMessage=d):d===!1&&(i.status="failed",i.validateMessage=te(c,l))})}),Promise.resolve()),k=()=>{i.status="unvalidated",i.validateMessage=""},A=()=>n("endValidate",{status:i.status,message:i.validateMessage}),P=(t=e.rules)=>new Promise(a=>{k(),t?(n("startValidate"),W(t).then(()=>{i.status==="failed"?(a({name:e.name,message:i.validateMessage}),A()):(i.status="passed",a(),A())})):a()}),T=t=>{if(m&&e.rules){const{validateTrigger:a}=m.props,l=p(a).includes(t),c=e.rules.filter(d=>d.trigger?p(d.trigger).includes(t):l);c.length&&P(c)}},q=t=>{var a;const{maxlength:l}=e;if(x(l)&&y(t)>+l){const c=I();if(c&&y(c)===+l)return c;const d=(a=s.value)==null?void 0:a.selectionEnd;if(i.focused&&d){const h=[...t],v=h.length-+l;return h.splice(d-v,v),h.join("")}return U(t,+l)}return t},C=(t,a="onChange")=>{const l=t;t=q(t);const c=y(l)-y(t);if(e.type==="number"||e.type==="digit"){const h=e.type==="number";t=Fe(t,h,h)}let d=0;if(e.formatter&&a===e.formatTrigger){const{formatter:h,maxlength:v}=e;if(t=h(t),x(v)&&y(t)>+v&&(t=U(t,+v)),s.value&&i.focused){const{selectionEnd:N}=s.value,G=U(l,N);d=y(h(G))-y(G)}}if(s.value&&s.value.value!==t)if(i.focused){let{selectionStart:h,selectionEnd:v}=s.value;if(s.value.value=t,x(h)&&x(v)){const N=y(t);c?(h-=c,v-=c):d&&(h+=d,v+=d),s.value.setSelectionRange(Math.min(h,N),Math.min(v,N))}}else s.value.value=t;t!==e.modelValue&&n("update:modelValue",t)},o=t=>{t.target.composing||C(t.target.value)},S=()=>{var t;return(t=s.value)==null?void 0:t.blur()},_=()=>{var t;return(t=s.value)==null?void 0:t.focus()},B=()=>{const t=s.value;e.type==="textarea"&&e.autosize&&t&&Je(t,e.autosize)},ue=t=>{i.focused=!0,n("focus",t),O(B),f("readonly")&&S()},de=t=>{i.focused=!1,C(I(),"onBlur"),n("blur",t),!f("readonly")&&(T("onBlur"),O(B),qe())},X=t=>n("clickInput",t),fe=t=>n("clickLeftIcon",t),ge=t=>n("clickRightIcon",t),me=t=>{$(t),n("update:modelValue",""),n("clear",t)},J=V(()=>{if(typeof e.error=="boolean")return e.error;if(m&&m.props.showError&&i.status==="failed")return!0}),he=V(()=>{const t=f("labelWidth"),a=f("labelAlign");if(t&&a!=="top")return{width:Q(t)}}),be=t=>{t.keyCode===13&&(!(m&&m.props.submitOnEnter)&&e.type!=="textarea"&&$(t),e.type==="search"&&S()),n("keypress",t)},Z=()=>e.id||`${g}-input`,ve=()=>i.status,ye=()=>{const t=b("control",[f("inputAlign"),{error:J.value,custom:!!r.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(r.input)return u("div",{class:t,onClick:X},[r.input()]);const a={id:Z(),ref:s,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:t,disabled:f("disabled"),readonly:f("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${g}-label`:void 0,onBlur:de,onFocus:ue,onInput:o,onClick:X,onChange:ne,onKeypress:be,onCompositionend:ne,onCompositionstart:Xe};return e.type==="textarea"?u("textarea",a,null):u("input",oe(Ze(e.type),a),null)},Ie=()=>{const t=r["left-icon"];if(e.leftIcon||t)return u("div",{class:b("left-icon"),onClick:fe},[t?t():u(j,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},ke=()=>{const t=r["right-icon"];if(e.rightIcon||t)return u("div",{class:b("right-icon"),onClick:ge},[t?t():u(j,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Ce=()=>{if(e.showWordLimit&&e.maxlength){const t=y(I());return u("div",{class:b("word-limit")},[u("span",{class:b("word-num")},[t]),We("/"),e.maxlength])}},Se=()=>{if(m&&m.props.showErrorMessage===!1)return;const t=e.errorMessage||i.validateMessage;if(t){const a=r["error-message"],l=f("errorMessageAlign");return u("div",{class:b("error-message",l)},[a?a({message:t}):t])}},Ve=()=>{const t=f("labelWidth"),a=f("labelAlign"),l=f("colon")?":":"";if(r.label)return[r.label(),l];if(e.label)return u("label",{id:`${g}-label`,for:r.input?void 0:Z(),onClick:c=>{$(c),_()},style:a==="top"&&t?{width:Q(t)}:void 0},[e.label+l])},xe=()=>[u("div",{class:b("body")},[ye(),z.value&&u(j,{ref:M,name:e.clearIcon,class:b("clear")},null),ke(),r.button&&u("div",{class:b("button")},[r.button()])]),Ce(),Se()];return re({blur:S,focus:_,validate:P,formValue:R,resetValidation:k,getValidationStatus:ve}),Ne(Oe,{customValue:w,resetValidation:k,validateWithTrigger:T}),De(()=>e.modelValue,()=>{C(I()),k(),T("onChange"),O(B)}),$e(()=>{C(I(),e.formatTrigger),O(B)}),ze("touchstart",me,{target:V(()=>{var t;return(t=M.value)==null?void 0:t.$el})}),()=>{const t=f("disabled"),a=f("labelAlign"),l=Ie(),c=()=>{const d=Ve();return a==="top"?[l,d].filter(Boolean):d||[]};return u(Ke,{size:e.size,class:b({error:J.value,disabled:t,[`label-${a}`]:a}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:he.value,valueClass:b("value"),titleClass:[b("label",[a,{required:F.value}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:l&&a!=="top"?()=>l:null,title:c,value:xe,extra:r.extra})}}});const et=ie(pe),[tt,L,nt]=ae("search"),at=H({},Y,{label:String,shape:E("square"),leftIcon:E("search"),clearable:je,actionText:String,background:String,showAction:Boolean});var lt=le({name:tt,props:at,emits:["blur","focus","clear","search","cancel","clickInput","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:n,slots:r,attrs:g}){const i=ce(),s=D(),M=()=>{r.action||(n("update:modelValue",""),n("cancel"))},w=o=>{o.keyCode===13&&($(o),n("search",e.modelValue))},m=()=>e.id||`${i}-input`,I=()=>{if(r.label||e.label)return u("label",{class:L("label"),for:m()},[r.label?r.label():e.label])},f=()=>{if(e.showAction){const o=e.actionText||nt("cancel");return u("div",{class:L("action"),role:"button",tabindex:0,onClick:M},[r.action?r.action():o])}},z=()=>{var o;return(o=s.value)==null?void 0:o.blur()},R=()=>{var o;return(o=s.value)==null?void 0:o.focus()},F=o=>n("blur",o),W=o=>n("focus",o),k=o=>n("clear",o),A=o=>n("clickInput",o),P=o=>n("clickLeftIcon",o),T=o=>n("clickRightIcon",o),q=Object.keys(Y),C=()=>{const o=H({},g,ee(e,q),{id:m()}),S=_=>n("update:modelValue",_);return u(et,oe({ref:s,type:"search",class:L("field",{"with-message":o.errorMessage}),border:!1,onBlur:F,onFocus:W,onClear:k,onKeypress:w,onClickInput:A,onClickLeftIcon:P,onClickRightIcon:T,"onUpdate:modelValue":S},o),ee(r,["left-icon","right-icon"]))};return re({focus:R,blur:z}),()=>{var o;return u("div",{class:L({"show-action":e.showAction}),style:{background:e.background}},[(o=r.left)==null?void 0:o.call(r),u("div",{class:L("content",e.shape)},[I(),C()]),f()])}}});const ct=ie(lt),st=""+new URL("huangshan-CXU9PTw5.jpg",import.meta.url).href;export{ct as S,st as _};
